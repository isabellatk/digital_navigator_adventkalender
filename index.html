<!DOCTYPE html>
<html lang="de">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Digital Navigator Adventkalender 2025</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <!-- IM Fell English Font für Header (Regulär) und SC für Türchen (Small Caps) -->
    <link href="https://fonts.googleapis.com/css2?family=IM+Fell+English:wght@400&family=IM+Fell+English+SC&display=swap" rel="stylesheet">
    <!-- Nunito Font für Body -->
    <link href="https://fonts.googleapis.com/css2?family=Nunito:wght@400;700&display=swap" rel="stylesheet">
    <style>
        /* --- GENERAL & FONTS --- */
        body {
            background-image: url('hintergrund2.jpg'); 
            background-color: #10162F; /* Fallback: Tiefes Marineblau */
            background-size: cover;
            background-attachment: fixed;
            background-position: center;
            overflow-x: hidden;
            font-family: 'Nunito', sans-serif;
            transition: all 1s ease;
        }

        /* H1 nutzt nun die reguläre IM Fell English */
        .header-title {
            font-family: 'IM Fell English', serif;
            color: #dcb639; /* Gold */
            text-shadow: 3px 3px 5px rgba(0, 0, 0, 0.5);
            font-size: 2.0rem; /* Default mobile */
        }
        @media (min-width: 700px) {
            .header-title {
                font-size: 2.5rem; /* Desktop/Tablet */
            }
        }
        
        /* H2: Entspannt durch die stürmische Adventszeit (BLAUER TEXT AUF GOLD) */
        .header-subtitle {
            font-family: 'IM Fell English', serif;
            background-color: #D4AF37; 
            color: #10162F; 
            box-shadow: 0 4px 6px rgba(0, 0, 0, 0.4); 
            display: inline-block; 
            padding: 0.4rem 1.5rem; 
            border-radius: 0.55rem; 
            margin-top: 0.5rem;
            margin-bottom: 0.5rem;
            font-size: 1.2rem;
        }
        @media (min-width: 640px) {
            .header-subtitle {
                font-size: 1.2rem;
            }
        }

        /* --- DOOR STYLES --- */
        .advent-door {
            transition: all 0.3s ease;
            box-shadow: 0 4px 6px -1px rgba(0, 0, 0, 0.4);
            border: 2px solid #D4AF37; 
        }

        .door-unopened {
            cursor: pointer;
            background-color: #800020d7; 
            color: #D4AF37;
            box-shadow: 0 10px 18px -1px rgba(0, 0, 0, 0.4), 
                        inset 0 0 0 5px #800020; 
        }
        
        .door-unopened:hover {
             transform: scale(1.05) rotate(1deg);
             box-shadow: 0 15px 25px -5px rgba(0, 0, 0, 0.4),
                         inset 0 0 0 5px #800020;
        }

        .door-locked {
            cursor: not-allowed;
            background: #10162F; 
            opacity: 0.95;
            filter: brightness(0.9);
            color: #D4AF37;
            border-color: #D4AF37; 
        }
        
        .door-opened {
            cursor: pointer;
            background-size: cover;
            background-position: center;
            background-repeat: no-repeat;
            color: #D4AF37;
            border-color: #D4AF37;
            box-shadow: inset 0 0 15px rgba(212, 175, 55, 0.5);
            transform: scale(0.95);
            position: relative;
        }

        .door-opened:hover {
             transform: scale(1.0) rotate(0deg);
             box-shadow: inset 0 10px 20px rgba(212, 175, 55, 0.7);
        }

        .door-number {
            font-size: 2.8rem;
            font-weight: 700;
            text-shadow: 1px 1px 3px rgba(0, 0, 0, 0.7);
            font-family: 'IM Fell English SC', serif;
        }
        
        .door-indicator {
            position: absolute;
            top: 0.5rem;
            right: 0.5rem;
            font-size: 1.25rem;
            font-weight: 700;
            color: #D4AF37;
            font-family: 'IM Fell English SC', serif;
            text-shadow: 1px 1px 3px rgba(0, 0, 0, 0.7);
        }

        /* --- LAYOUT & RESPONSIVENESS FIX --- */
        .advent-grid {
            grid-template-columns: repeat(3, 1fr);
        }
        @media (min-width: 768px) {
            .advent-grid {
                grid-template-columns: repeat(6, 1fr);
            }
        }
        
        /* Loading Spinner */
        .spinner {
            border: 4px solid rgba(255, 255, 255, 0.3);
            border-radius: 50%;
            border-top: 4px solid #D4AF37;
            width: 40px;
            height: 40px;
            animation: spin 1s linear infinite;
        }
        @keyframes spin {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }

        .snowflake {
            position: fixed;
            top: -10px;
            color: white;
            font-size: 1em;
            pointer-events: none;
            animation-name: snowfall;
            animation-timing-function: linear;
            animation-iteration-count: infinite;
        }
        @keyframes snowfall {
            0% { transform: translateY(0) rotate(0deg); }
            100% { transform: translateY(110vh) rotate(360deg); }
        }

        /* Miniüberschrift im Modal */
        .tip-title {
            font-family: 'IM Fell English', serif; 
            font-size: 1.5rem;
            font-weight: 700;
            color: #800020;
            margin-bottom: 0.5rem;
            display: block; 
        }

        /* ================================================================================= */
        /* ANPASSUNG FÜR TÜRE 24                                                             */
        /* ================================================================================= */
        #advent-grid [data-day="24"] {
            grid-column: span 2;
            grid-row: span 2;
            z-index: 10;
            border: 4px solid #FFD700;
            box-shadow: 0 10px 20px -5px rgba(255, 215, 0, 0.5), 0 6px 10px rgba(0, 0, 0, 0.5); 
        }

        #advent-grid [data-day="24"] .door-number {
            font-size: 5.5rem; 
            letter-spacing: 0.05em;
        }  
        /* ================================================================================= */
        /* ENDE ANPASSUNG TÜRE 24                                                            */
        /* ================================================================================= */
    </style>
</head>
<body class="text-white min-h-screen p-4 sm:p-8" id="app-body">

    <!-- Schneeflocken Container -->
    <div id="snow-container"></div>

    <!-- Loading Screen Overlay -->
    <div id="loading-overlay" class="fixed inset-0 bg-gray-900 flex flex-col items-center justify-center z-50 transition-opacity duration-500">
        <div class="spinner mb-4"></div>
        <p class="text-lg text-white" id="loading-text">Lade Kalender...</p>
        <p class="text-sm text-gray-400 mt-2" id="loading-subtext">(Bitte warten)</p>
    </div>

    <!-- Haupt-Container -->
    <div id="main-content" class="p-4 sm:p-10 rounded-xl shadow-2xl max-w-6xl mx-auto hidden">
        
        <header class="text-center mb-10">
            <h1 class="text-gold-600 mb-2 header-title">
                - DIGITAL NAVIGATOR - Adventkalender 2025
            </h1>
            <h2 class="font-bold header-subtitle">
                Entspannt durch die stürmische Adventszeit
            </h2>

            <!-- Zarter Trenner unter dem Header -->
            <div class="mt-4 flex items-center justify-center gap-3 text-yellow-300/80">
                <span class="h-px w-12 sm:w-16 bg-yellow-300/60 block"></span>
                <span class="text-lg sm:text-xl align-middle">✶</span>
                <span class="h-px w-12 sm:w-16 bg-yellow-300/60 block"></span>
            </div>

            <!-- Sprachumschalter -->
            <div class="mt-4 flex justify-center gap-2 text-sm">
                <button id="lang-de" type="button"
                        class="px-3 py-1 rounded-full border border-yellow-300 bg-yellow-300/20 text-yellow-100 opacity-100">
                    DE
                </button>
                <button id="lang-en" type="button"
                        class="px-3 py-1 rounded-full border border-yellow-300 bg-transparent text-yellow-100 opacity-50">
                    EN
                </button>
            </div>
        </header>

        <!-- Container für die 24 Türchen -->
        <div id="advent-grid" class="advent-grid grid gap-8 sm:gap-8">
            <!-- Türchen werden hier per JavaScript eingefügt -->
        </div>
        <div id="info-message" class="col-span-full text-center text-lg mt-4 p-4 bg-red-800/80 rounded-xl shadow-inner text-yellow-100 hidden"></div>

    </div>

    <!-- Modal für die Anzeige der Tipps -->
    <div id="modal" class="fixed inset-0 bg-black bg-opacity-75 hidden z-50 flex items-center justify-center p-4">
        <div class="bg-yellow-50 w-full max-w-lg p-6 sm:p-8 rounded-2xl transform transition-all duration-300 scale-100 text-black">
            
            <!-- FIX 1 APPLIED HERE -->
            <h2 id="modal-title" class="text-2xl sm:text-3xl font-bold mb-3 text-red-700 uppercase"></h2>

            <div id="modal-content" class="text-lg mb-6 font-medium"></div>
            <button id="modal-close-button" onclick="closeModal()" class="w-full bg-red-700 hover:bg-red-800 text-white font-bold py-3 rounded-xl transition duration-200 shadow-lg">
                Schließen & genießen
            </button>
        </div>
    </div>

    <footer class="mt-12 mb-6 text-xs text-yellow-100/80 text-center max-w-3xl mx-auto leading-relaxed">
        <p id="footer-text">
            © 2025 Department of Geoinformatics – Z_GIS, University of Salzburg. Dieser Adventkalender wurde im Rahmen
            des Projekts „Digital Navigator“, einem Projekt des iDEAS:lab, erstellt.
        </p>
    </footer>

<script>
    // --- CONFIGURATION ---
    const testingOverride = false; 
    const TARGET_YEAR = 2025; 
    const DOOR_ORDER = [10, 2, 18, 5, 23, 1, 14, 8, 20, 3, 16, 12, 6, 22, 9, 17, 4, 19, 11, 24, 7, 15, 13, 21];
    
    let openedDoors = []; 
    const doorElements = {}; 

    // Sprache
    let currentLang = 'de';
    const savedLang = localStorage.getItem('dn_advent_lang');
    if (savedLang === 'en' || savedLang === 'de') {
        currentLang = savedLang;
    }

    const TEXT = {
        de: {
            title: 'Digital Navigator Adventkalender 2025',
            headerTitle: '- DIGITAL NAVIGATOR - Adventkalender 2025',
            headerSubtitle: 'Entspannt durch die stürmische Adventszeit',
            loadingText: 'Lade Kalender...',
            loadingSubtext: '(Bitte warten)',
            modalTitlePrefix: 'Türchen',
            modalClose: 'Schließen & genießen',
            notActiveMessage: (year) => `Achtung: Der Kalender ist momentan noch verschlossen. Er öffnet sich automatisch am 1. Dezember ${year}!`,
            footer: '© 2025 Department of Geoinformatics – Z_GIS, University of Salzburg. Dieser Adventkalender wurde im Rahmen des Projekts „Digital Navigator“, einem Projekt des iDEAS:lab, erstellt.'
        },
        en: {
            title: 'Digital Navigator Advent Calendar 2025',
            headerTitle: '- DIGITAL NAVIGATOR - Advent Calendar 2025',
            headerSubtitle: 'Staying calm in a stormy Advent season',
            loadingText: 'Loading calendar...',
            loadingSubtext: '(Please wait)',
            modalTitlePrefix: 'Day',
            modalClose: 'Close & enjoy',
            notActiveMessage: (year) => `Note: The calendar is currently locked. It will open automatically on 1 December ${year}.`,
            footer: '© 2025 Department of Geoinformatics – Z_GIS, University of Salzburg. This advent calendar was created as part of the “Digital Navigator” project by iDEAS:lab.'
        }
    };

    // 24 Resilienz-Tipps in DE und EN
    const CYBER_SPA_TIPS = {
        de: [...CYBER SPA TIPS CONTENT...],
        en: [...CYBER SPA TIPS CONTENT...]
    };

    function applyLanguage() {
        const t = TEXT[currentLang];

        document.title = t.title;
        document.documentElement.lang = currentLang === 'de' ? 'de' : 'en';

        const headerTitleEl = document.querySelector('.header-title');
        if (headerTitleEl) headerTitleEl.textContent = t.headerTitle;

        const headerSubtitleEl = document.querySelector('.header-subtitle');
        if (headerSubtitleEl) headerSubtitleEl.textContent = t.headerSubtitle;

        const loadingTextEl = document.getElementById('loading-text');
        if (loadingTextEl) loadingTextEl.textContent = t.loadingText;

        const loadingSubEl = document.getElementById('loading-subtext');
        if (loadingSubEl) loadingSubEl.textContent = t.loadingSubtext;

        const footerTextEl = document.getElementById('footer-text');
        if (footerTextEl) footerTextEl.textContent = t.footer;

        const modalCloseBtn = document.getElementById('modal-close-button');
        if (modalCloseBtn) modalCloseBtn.textContent = t.modalClose;

        const infoMessage = document.getElementById('info-message');
        if (!infoMessage.classList.contains('hidden') && currentAdventDay === 0 && !testingOverride) {
            infoMessage.textContent = t.notActiveMessage(TARGET_YEAR);
        }

        const btnDe = document.getElementById('lang-de');
        const btnEn = document.getElementById('lang-en');
        if (btnDe && btnEn) {
            if (currentLang === 'de') {
                btnDe.classList.remove('opacity-50', 'bg-transparent');
                btnDe.classList.add('opacity-100', 'bg-yellow-300/20');
                btnEn.classList.remove('opacity-100', 'bg-yellow-300/20');
                btnEn.classList.add('opacity-50', 'bg-transparent');
            } else {
                btnEn.classList.remove('opacity-50', 'bg-transparent');
                btnEn.classList.add('opacity-100', 'bg-yellow-300/20');
                btnDe.classList.remove('opacity-100', 'bg-yellow-300/20');
                btnDe.classList.add('opacity-50', 'bg-transparent');
            }
        }
    }

    function setLanguage(lang) {
        if (lang !== 'de' && lang !== 'en') return;
        if (currentLang === lang) return;
        currentLang = lang;
        localStorage.setItem('dn_advent_lang', currentLang);
        applyLanguage();
        if (currentAdventDay === 0 && !testingOverride) {
            updateDoorVisuals();
        }
    }

    function getCurrentAdventDay() {
        if (testingOverride) {
            return 24;
        }
        
        const today = new Date();
        const currentYear = today.getFullYear();
        const currentMonth = today.getMonth();
        const currentDate = today.getDate();

        if (currentYear === TARGET_YEAR && currentMonth === 11) { 
            if (currentDate >= 1 && currentDate <= 24) {
                return currentDate;
            } else if (currentDate > 24) {
                return 24;
            }
        } 
        return 0;
    }

    let currentAdventDay = getCurrentAdventDay();

    function createDoor(day) {
        const doorElement = document.createElement('div');
        doorElement.className = 'advent-door relative aspect-square rounded-xl flex items-center justify-center select-none';
        doorElement.setAttribute('data-day', day);
        doorElement.innerHTML = `<span class="door-number">${day}</span>`;
        doorElements[day] = doorElement;
        return doorElement;
    }

    function updateDoorVisuals() {
        const infoMessage = document.getElementById('info-message');
        infoMessage.classList.add('hidden');
        
        if (currentAdventDay === 0 && !testingOverride) {
            infoMessage.textContent = TEXT[currentLang].notActiveMessage(TARGET_YEAR);
            infoMessage.classList.remove('hidden');
        }

        for (const day of DOOR_ORDER) {
            const doorElement = doorElements[day];
            if (!doorElement) continue;

            const isAvailable = day <= currentAdventDay;
            const isOpen = openedDoors.includes(day);

            doorElement.classList.remove('door-locked', 'door-unopened', 'door-opened');
            doorElement.removeAttribute('onclick');
            doorElement.style.backgroundImage = 'none';
            doorElement.innerHTML = `<span class="door-number">${day}</span>`;

            if (!isAvailable) {
                doorElement.classList.add('door-locked');
                doorElement.innerHTML += `
                    <svg class="absolute top-2 right-2 w-4 h-4" fill="currentColor" style="color: #D4AF37;" viewBox="0 0 20 20">
                        <path fill-rule="evenodd" d="M10 1a4 4 0 00-4 4v2h8V5a4 4 0 00-4-4zm0 10a2 2 0 100-4 2 2 0 000 4z" clip-rule="evenodd" />
                    </svg>
                `;
            } else if (isOpen) {
                doorElement.classList.add('door-opened');
                doorElement.style.backgroundImage = `url('bild${day.toString().padStart(2, '0')}.png')`;
                doorElement.setAttribute('onclick', `openModal(${day})`);
                doorElement.innerHTML = ``;
                doorElement.innerHTML += `<span class="door-indicator">${day}</span>`;
            } else {
                doorElement.classList.add('door-unopened');
                doorElement.setAttribute('onclick', `openDoor(${day})`);
            }
        }
    }

    function renderAdventCalendar() {
        const grid = document.getElementById('advent-grid');
        grid.innerHTML = ''; 
        
        DOOR_ORDER.forEach(day => {
            const door = createDoor(day);
            grid.appendChild(door);
        });
        
        updateDoorVisuals(); 
        hideLoadingScreen();
    }
    
    function hideLoadingScreen() {
        document.getElementById('loading-overlay').classList.add('opacity-0');
        setTimeout(() => {
            document.getElementById('loading-overlay').classList.add('hidden');
            document.getElementById('main-content').classList.remove('hidden');
        }, 500);
    }
    
    window.openDoor = function(day) {
        if (day > currentAdventDay || openedDoors.includes(day)) return;
        openedDoors.push(day);
        updateDoorVisuals();
        openModal(day);
    }

    /* FIX 2 APPLIED HERE */
    window.openModal = function(day) {
        const fullTip = CYBER_SPA_TIPS[currentLang][day - 1];

        const firstColonIndex = fullTip.indexOf(":");
        let title = fullTip;
        let content = "";

        if (firstColonIndex !== -1) {
            title = fullTip.substring(0, firstColonIndex);
            content = fullTip.substring(firstColonIndex + 1);
        }

        const t = TEXT[currentLang];
        document.getElementById('modal-title').textContent = `${t.modalTitlePrefix} ${day}`;
        
        const modalContentEl = document.getElementById('modal-content');
        modalContentEl.innerHTML = `
            <span class="tip-title">${title.trim()}</span>
            <p class="mb-0">${content.trim()}</p>
        `;

        document.getElementById('modal').classList.remove('hidden');
    }

    window.closeModal = function() {
        document.getElementById('modal').classList.add('hidden');
    }

    function createSnow() {
        const snowContainer = document.getElementById('snow-container');
        if (!snowContainer) return;
        for (let i = 0; i < 60; i++) {
            const snow = document.createElement('div');
            snow.className = 'snowflake';
            snow.textContent = '❄';
            snow.style.left = Math.random() * 100 + 'vw';
            snow.style.fontSize = (Math.random() * 10 + 10) + 'px';
            snow.style.opacity = Math.random();
            snow.style.animationDuration = (Math.random() * 5 + 5) + 's';
            snowContainer.appendChild(snow);
        }
    }

    document.addEventListener('DOMContentLoaded', () => {
        const btnDe = document.getElementById('lang-de');
        const btnEn = document.getElementById('lang-en');
        if (btnDe) btnDe.addEventListener('click', () => setLanguage('de'));
        if (btnEn) btnEn.addEventListener('click', () => setLanguage('en'));

        applyLanguage();
        renderAdventCalendar();
        createSnow();
    });
</script>
</body>
</html>


